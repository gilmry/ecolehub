ðŸŒ i18n-lint (STRICT)
ðŸŒ i18n-lint (STRICT)
i18n-lint: 0 potential hardcoded strings found in frontend/index.html
i18n-lint: OK
ðŸ Backend: environment
ðŸ“¦ Ensure test dependencies (best effort)
ðŸ”§ Install formatting tools
ðŸŽ¨ Auto-formatting Python code
ðŸŽ¨ Formatage automatique du code Python
  ðŸ§¹ autoflake: suppression des imports/variables inutilisÃ©s
  ðŸ“š isort: tri des imports
  ðŸ”§ autopep8: corrections PEP8 conservatrices
  âš« black: formatage final
âœ… Formatage terminÃ©
ðŸ” flake8 (strict then relaxed)
0
app/secrets_manager.py:25:5: C901 'SecretsManager.read_secret' is too complex (11)
1     C901 'SecretsManager.read_secret' is too complex (11)
1
ðŸ“¦ Installing backend dependencies (runtime + test)
ðŸ”Ž Checking requirements alignment
âœ… Requirements sync OK (fastapi, python-jose, python-multipart, pydantic)
ðŸ§ª Pytest: unit
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-7.4.3, pluggy-1.6.0 -- /home/user/schoolhub/backend/venv/bin/python
cachedir: .pytest_cache
rootdir: /home/user/schoolhub/backend
configfile: pytest.ini
plugins: env-1.1.3, cov-4.1.0, Faker-20.1.0, anyio-3.7.1, mock-3.12.0, asyncio-0.21.1, xdist-3.5.0
asyncio: mode=Mode.STRICT
collecting ... collected 40 items / 25 deselected / 15 selected

tests/unit/test_belgian_context.py::TestBelgianSchoolSystem::test_belgian_class_levels PASSED [  6%]
tests/unit/test_belgian_context.py::TestBelgianSchoolSystem::test_ceb_level_recognition PASSED [ 13%]
tests/unit/test_belgian_context.py::TestChildManagement::test_create_child_with_belgian_class PASSED [ 20%]
tests/unit/test_belgian_context.py::TestChildManagement::test_invalid_class_level_rejected PASSED [ 26%]
tests/unit/test_belgian_context.py::TestChildManagement::test_get_children_by_parent PASSED [ 33%]
tests/unit/test_belgian_context.py::TestChildManagement::test_child_class_progression PASSED [ 40%]
tests/unit/test_belgian_context.py::TestBelgianLocalization::test_default_language_french_belgian PASSED [ 46%]
tests/unit/test_belgian_context.py::TestBelgianLocalization::test_supported_languages PASSED [ 53%]
tests/unit/test_belgian_context.py::TestBelgianLocalization::test_belgian_currency_euro PASSED [ 60%]
tests/unit/test_belgian_context.py::TestBelgianSchoolEvents::test_belgian_school_events PASSED [ 66%]
tests/unit/test_belgian_context.py::TestBelgianSchoolEvents::test_saint_nicolas_date PASSED [ 73%]
tests/unit/test_belgian_context.py::TestBelgianSchoolEvents::test_school_year_belgian_calendar PASSED [ 80%]
tests/unit/test_belgian_context.py::TestBelgianSELContext::test_sel_service_categories_belgian PASSED [ 86%]
tests/unit/test_belgian_context.py::TestBelgianSELContext::test_sel_units_system PASSED [ 93%]
tests/unit/test_belgian_context.py::TestBelgianSELContext::test_belgian_working_hours_context PASSED [100%]

=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

app/models_stage1.py:19
  /home/user/schoolhub/backend/app/models_stage1.py:19: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

app/schemas_stage1.py:150
  /home/user/schoolhub/backend/app/schemas_stage1.py:150: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("units")

app/schemas_stage1.py:186
  /home/user/schoolhub/backend/app/schemas_stage1.py:186: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("balance")

tests/unit/test_auth.py:73
  /home/user/schoolhub/backend/tests/unit/test_auth.py:73: PytestUnknownMarkWarning: Unknown pytest.mark.auth - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.auth

tests/unit/test_belgian_context.py:9
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:37
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:37: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:99
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:99: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:125
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:125: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:164
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:164: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_sel_system.py:10
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:10: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:61
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:61: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:179
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:179: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_belgian_context.py::TestChildManagement::test_create_child_with_belgian_class
tests/unit/test_belgian_context.py::TestChildManagement::test_invalid_class_level_rejected
tests/unit/test_belgian_context.py::TestChildManagement::test_get_children_by_parent
  /home/user/schoolhub/backend/app/main_stage4.py:227: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(days=ACCESS_TOKEN_EXPIRE_DAYS)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================ 15 passed, 25 deselected, 24 warnings in 1.35s ================
ðŸ§ª Pytest: integration
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-7.4.3, pluggy-1.6.0 -- /home/user/schoolhub/backend/venv/bin/python
cachedir: .pytest_cache
rootdir: /home/user/schoolhub/backend
configfile: pytest.ini
plugins: env-1.1.3, cov-4.1.0, Faker-20.1.0, anyio-3.7.1, mock-3.12.0, asyncio-0.21.1, xdist-3.5.0
asyncio: mode=Mode.STRICT
collecting ... collected 20 items

tests/integration/test_api_complete_flows.py::TestCompleteUserJourney::test_complete_parent_onboarding_flow PASSED [  5%]
tests/integration/test_api_complete_flows.py::TestSELTransactionFlow::test_complete_sel_transaction_flow PASSED [ 10%]
tests/integration/test_api_complete_flows.py::TestMessageAndEventFlow::test_message_service_owner_flow PASSED [ 15%]
tests/integration/test_api_complete_flows.py::TestAdminWorkflow::test_admin_user_management PASSED [ 20%]
tests/integration/test_api_complete_flows.py::TestAdminWorkflow::test_admin_service_moderation PASSED [ 25%]
tests/integration/test_api_complete_flows.py::TestHealthAndMonitoring::test_health_endpoint_comprehensive PASSED [ 30%]
tests/integration/test_api_complete_flows.py::TestHealthAndMonitoring::test_metrics_endpoint_for_prometheus PASSED [ 35%]
tests/integration/test_database_operations.py::TestUserDatabaseOperations::test_create_user_with_relationships PASSED [ 40%]
tests/integration/test_database_operations.py::TestUserDatabaseOperations::test_user_email_uniqueness_constraint PASSED [ 45%]
tests/integration/test_database_operations.py::TestUserDatabaseOperations::test_user_soft_delete PASSED [ 50%]
tests/integration/test_database_operations.py::TestSELDatabaseOperations::test_sel_transaction_with_balance_updates PASSED [ 55%]
tests/integration/test_database_operations.py::TestSELDatabaseOperations::test_sel_balance_constraints PASSED [ 60%]
tests/integration/test_database_operations.py::TestSELDatabaseOperations::test_cascade_delete_protection PASSED [ 65%]
tests/integration/test_database_operations.py::TestChildDatabaseOperations::test_child_class_level_validation PASSED [ 70%]
tests/integration/test_database_operations.py::TestChildDatabaseOperations::test_multiple_children_per_parent PASSED [ 75%]
tests/integration/test_database_operations.py::TestDatabasePerformance::test_user_with_children_single_query PASSED [ 80%]
tests/integration/test_database_operations.py::TestDatabasePerformance::test_sel_services_with_provider_info PASSED [ 85%]
tests/integration/test_stage4_endpoints.py::test_i18n_locales_available PASSED [ 90%]
tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only PASSED [ 95%]
tests/integration/test_stage4_endpoints.py::test_shop_admin_create_and_list_products PASSED [100%]

=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

app/models_stage1.py:19
  /home/user/schoolhub/backend/app/models_stage1.py:19: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

app/schemas_stage1.py:150
  /home/user/schoolhub/backend/app/schemas_stage1.py:150: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("units")

app/schemas_stage1.py:186
  /home/user/schoolhub/backend/app/schemas_stage1.py:186: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("balance")

tests/integration/test_api_complete_flows.py:9
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:82
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:82: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:183
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:183: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:252
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:252: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:294
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:294: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:11
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:11: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:98
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:98: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:230
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:230: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:300
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:300: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:6
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:6: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:15
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:15: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:49
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:49: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py: 10 warnings
tests/integration/test_stage4_endpoints.py: 4 warnings
  /home/user/schoolhub/backend/app/analytics_service.py:350: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow().isoformat(),

tests/integration/test_api_complete_flows.py: 10 warnings
tests/integration/test_stage4_endpoints.py: 4 warnings
  /home/user/schoolhub/backend/app/analytics_service.py:355: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    key = f"analytics:user_actions:{datetime.utcnow().date()}"

tests/integration/test_api_complete_flows.py: 12 warnings
tests/integration/test_stage4_endpoints.py: 4 warnings
  /home/user/schoolhub/backend/app/main_stage4.py:227: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(days=ACCESS_TOKEN_EXPIRE_DAYS)

tests/integration/test_database_operations.py::TestUserDatabaseOperations::test_user_email_uniqueness_constraint
  /home/user/schoolhub/backend/tests/conftest.py:55: SAWarning: transaction already deassociated from connection
    transaction.rollback()

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:71: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    .filter(User.created_at >= datetime.utcnow() - timedelta(days=7))

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:93: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    .filter(Message.created_at >= datetime.utcnow().date())

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:102: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    and_(Event.start_date >= datetime.utcnow(), Event.is_active is True)

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:137: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow().isoformat(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================= 20 passed, 73 warnings in 13.69s =======================
ðŸ§ª Pytest: auth
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-7.4.3, pluggy-1.6.0 -- /home/user/schoolhub/backend/venv/bin/python
cachedir: .pytest_cache
rootdir: /home/user/schoolhub/backend
configfile: pytest.ini
plugins: env-1.1.3, cov-4.1.0, Faker-20.1.0, anyio-3.7.1, mock-3.12.0, asyncio-0.21.1, xdist-3.5.0
asyncio: mode=Mode.STRICT
collecting ... collected 71 items / 61 deselected / 10 selected

tests/unit/test_auth.py::TestAuthenticationEndpoints::test_register_new_user PASSED [ 10%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_register_duplicate_email PASSED [ 20%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_register_invalid_email PASSED [ 30%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_login_valid_credentials PASSED [ 40%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_login_invalid_email PASSED [ 50%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_login_invalid_password PASSED [ 60%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_login_inactive_user PASSED [ 70%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_get_current_user_valid_token PASSED [ 80%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_get_current_user_no_token PASSED [ 90%]
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_get_current_user_invalid_token PASSED [100%]

=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

app/models_stage1.py:19
  /home/user/schoolhub/backend/app/models_stage1.py:19: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

app/schemas_stage1.py:150
  /home/user/schoolhub/backend/app/schemas_stage1.py:150: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("units")

app/schemas_stage1.py:186
  /home/user/schoolhub/backend/app/schemas_stage1.py:186: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("balance")

tests/integration/test_api_complete_flows.py:9
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:82
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:82: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:183
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:183: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:252
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:252: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:294
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:294: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:11
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:11: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:98
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:98: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:230
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:230: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:300
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:300: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:6
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:6: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:15
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:15: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:49
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:49: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/unit/test_auth.py:73
  /home/user/schoolhub/backend/tests/unit/test_auth.py:73: PytestUnknownMarkWarning: Unknown pytest.mark.auth - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.auth

tests/unit/test_belgian_context.py:9
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:37
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:37: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:99
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:99: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:125
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:125: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:164
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:164: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_sel_system.py:10
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:10: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:61
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:61: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:179
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:179: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_auth.py::TestAuthenticationEndpoints::test_register_new_user
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_login_valid_credentials
  /home/user/schoolhub/backend/app/analytics_service.py:350: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow().isoformat(),

tests/unit/test_auth.py::TestAuthenticationEndpoints::test_register_new_user
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_login_valid_credentials
  /home/user/schoolhub/backend/app/analytics_service.py:355: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    key = f"analytics:user_actions:{datetime.utcnow().date()}"

tests/unit/test_auth.py::TestAuthenticationEndpoints::test_register_new_user
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_login_valid_credentials
tests/unit/test_auth.py::TestAuthenticationEndpoints::test_get_current_user_valid_token
  /home/user/schoolhub/backend/app/main_stage4.py:227: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(days=ACCESS_TOKEN_EXPIRE_DAYS)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================ 10 passed, 61 deselected, 40 warnings in 2.51s ================
ðŸ§ª Pytest: sel
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-7.4.3, pluggy-1.6.0 -- /home/user/schoolhub/backend/venv/bin/python
cachedir: .pytest_cache
rootdir: /home/user/schoolhub/backend
configfile: pytest.ini
plugins: env-1.1.3, cov-4.1.0, Faker-20.1.0, anyio-3.7.1, mock-3.12.0, asyncio-0.21.1, xdist-3.5.0
asyncio: mode=Mode.STRICT
collecting ... collected 71 items / 61 deselected / 10 selected

tests/unit/test_sel_system.py::TestSELBalance::test_initial_balance_120_units PASSED [ 10%]
tests/unit/test_sel_system.py::TestSELBalance::test_balance_limits_belgian_rules PASSED [ 20%]
tests/unit/test_sel_system.py::TestSELBalance::test_units_per_hour_standard_60 PASSED [ 30%]
tests/unit/test_sel_system.py::TestSELServices::test_create_sel_service PASSED [ 40%]
tests/unit/test_sel_system.py::TestSELServices::test_list_available_services PASSED [ 50%]
tests/unit/test_sel_system.py::TestSELServices::test_get_my_services PASSED [ 60%]
tests/unit/test_sel_system.py::TestSELServices::test_service_categories_belgian_context PASSED [ 70%]
tests/unit/test_sel_system.py::TestSELTransactions::test_transaction_balance_validation PASSED [ 80%]
tests/unit/test_sel_system.py::TestSELTransactions::test_get_user_transactions PASSED [ 90%]
tests/unit/test_sel_system.py::TestSELTransactions::test_get_balance PASSED [100%]

=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

app/models_stage1.py:19
  /home/user/schoolhub/backend/app/models_stage1.py:19: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

app/schemas_stage1.py:150
  /home/user/schoolhub/backend/app/schemas_stage1.py:150: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("units")

app/schemas_stage1.py:186
  /home/user/schoolhub/backend/app/schemas_stage1.py:186: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("balance")

tests/integration/test_api_complete_flows.py:9
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:82
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:82: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:183
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:183: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:252
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:252: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:294
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:294: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:11
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:11: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:98
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:98: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:230
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:230: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:300
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:300: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:6
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:6: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:15
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:15: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:49
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:49: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/unit/test_auth.py:73
  /home/user/schoolhub/backend/tests/unit/test_auth.py:73: PytestUnknownMarkWarning: Unknown pytest.mark.auth - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.auth

tests/unit/test_belgian_context.py:9
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:37
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:37: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:99
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:99: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:125
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:125: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:164
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:164: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_sel_system.py:10
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:10: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:61
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:61: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:179
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:179: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py::TestSELServices::test_create_sel_service
tests/unit/test_sel_system.py::TestSELServices::test_list_available_services
tests/unit/test_sel_system.py::TestSELServices::test_get_my_services
tests/unit/test_sel_system.py::TestSELTransactions::test_get_user_transactions
tests/unit/test_sel_system.py::TestSELTransactions::test_get_balance
  /home/user/schoolhub/backend/app/main_stage4.py:227: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(days=ACCESS_TOKEN_EXPIRE_DAYS)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================ 10 passed, 61 deselected, 38 warnings in 1.81s ================
ðŸ“Š Coverage
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-7.4.3, pluggy-1.6.0
rootdir: /home/user/schoolhub/backend
configfile: pytest.ini
plugins: env-1.1.3, cov-4.1.0, Faker-20.1.0, anyio-3.7.1, mock-3.12.0, asyncio-0.21.1, xdist-3.5.0
asyncio: mode=Mode.STRICT
collected 71 items

tests/test_makefile_integration.py ...........                           [ 15%]
tests/integration/test_api_complete_flows.py .......                     [ 25%]
tests/integration/test_database_operations.py ..........                 [ 39%]
tests/integration/test_stage4_endpoints.py ...                           [ 43%]
tests/unit/test_auth.py ...............                                  [ 64%]
tests/unit/test_belgian_context.py ...............                       [ 85%]
tests/unit/test_sel_system.py ..........                                 [100%]

=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

app/models_stage1.py:19
  /home/user/schoolhub/backend/app/models_stage1.py:19: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
  /home/user/schoolhub/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

app/schemas_stage1.py:150
  /home/user/schoolhub/backend/app/schemas_stage1.py:150: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("units")

app/schemas_stage1.py:186
  /home/user/schoolhub/backend/app/schemas_stage1.py:186: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("balance")

tests/integration/test_api_complete_flows.py:9
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:82
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:82: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:183
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:183: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:252
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:252: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_api_complete_flows.py:294
  /home/user/schoolhub/backend/tests/integration/test_api_complete_flows.py:294: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:11
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:11: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:98
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:98: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:230
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:230: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_database_operations.py:300
  /home/user/schoolhub/backend/tests/integration/test_database_operations.py:300: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:6
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:6: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:15
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:15: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/integration/test_stage4_endpoints.py:49
  /home/user/schoolhub/backend/tests/integration/test_stage4_endpoints.py:49: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/unit/test_auth.py:73
  /home/user/schoolhub/backend/tests/unit/test_auth.py:73: PytestUnknownMarkWarning: Unknown pytest.mark.auth - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.auth

tests/unit/test_belgian_context.py:9
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:9: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:37
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:37: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:99
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:99: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:125
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:125: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_belgian_context.py:164
  /home/user/schoolhub/backend/tests/unit/test_belgian_context.py:164: PytestUnknownMarkWarning: Unknown pytest.mark.unit - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.unit

tests/unit/test_sel_system.py:10
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:10: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:61
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:61: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/unit/test_sel_system.py:179
  /home/user/schoolhub/backend/tests/unit/test_sel_system.py:179: PytestUnknownMarkWarning: Unknown pytest.mark.sel - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.sel

tests/integration/test_api_complete_flows.py: 10 warnings
tests/integration/test_stage4_endpoints.py: 4 warnings
tests/unit/test_auth.py: 2 warnings
  /home/user/schoolhub/backend/app/analytics_service.py:350: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow().isoformat(),

tests/integration/test_api_complete_flows.py: 10 warnings
tests/integration/test_stage4_endpoints.py: 4 warnings
tests/unit/test_auth.py: 2 warnings
  /home/user/schoolhub/backend/app/analytics_service.py:355: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    key = f"analytics:user_actions:{datetime.utcnow().date()}"

tests/integration/test_api_complete_flows.py: 12 warnings
tests/integration/test_stage4_endpoints.py: 4 warnings
tests/unit/test_auth.py: 5 warnings
tests/unit/test_belgian_context.py: 3 warnings
tests/unit/test_sel_system.py: 5 warnings
  /home/user/schoolhub/backend/app/main_stage4.py:227: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(days=ACCESS_TOKEN_EXPIRE_DAYS)

tests/integration/test_database_operations.py::TestUserDatabaseOperations::test_user_email_uniqueness_constraint
  /home/user/schoolhub/backend/tests/conftest.py:55: SAWarning: transaction already deassociated from connection
    transaction.rollback()

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:71: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    .filter(User.created_at >= datetime.utcnow() - timedelta(days=7))

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:93: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    .filter(Message.created_at >= datetime.utcnow().date())

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:102: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    and_(Event.start_date >= datetime.utcnow(), Event.is_active is True)

tests/integration/test_stage4_endpoints.py::test_platform_analytics_admin_only
  /home/user/schoolhub/backend/app/analytics_service.py:137: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow().isoformat(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform linux, python 3.12.3-final-0 -----------
Name                                Stmts   Miss  Cover
-------------------------------------------------------
app/analytics_service.py              105     41    61%
app/db_types.py                        24      6    75%
app/main.py                           160    160     0%
app/main_stage1.py                    184    184     0%
app/main_stage2.py                    316    316     0%
app/main_stage3.py                    364    364     0%
app/main_stage4.py                    379     83    78%
app/minio_service.py                   94     71    24%
app/models/__init__.py                  0      0   100%
app/models/user.py                      5      5     0%
app/models_stage1.py                   88      0   100%
app/models_stage2.py                   85      0   100%
app/models_stage3.py                   96      0   100%
app/mollie_service.py                  63     38    40%
app/schemas/__init__.py                 0      0   100%
app/schemas/user.py                     6      0   100%
app/schemas_stage1.py                 146      4    97%
app/secrets_manager.py                105     54    49%
app/security.py                        24     24     0%
app/sel_service.py                    112     31    72%
app/shop_service.py                    94     62    34%
app/websocket_manager.py              133    133     0%
app/workers/__init__.py                 0      0   100%
app/workers/celery_app.py               8      8     0%
app/workers/notification_tasks.py      43     43     0%
app/workers/shop_tasks.py              43     43     0%
-------------------------------------------------------
TOTAL                                2677   1670    38%
Coverage XML written to file coverage.xml

======================= 71 passed, 99 warnings in 20.53s =======================
âœ… Backend CI script completed
ðŸ›¡ï¸ Security scans (optional)
Run started:2025-09-20 15:39:30.953437

Test results:
	No issues identified.

Code scanned:
	Total lines of code: 5482
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 3
		Medium: 0
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 1
		High: 2
Files skipped (0):
Safety 3.6.1 scanning /home/user/schoolhub
2025-09-20 15:39:32 UTC

Account: gilles maury, gilmry@gmail.com 
Project: schoolhub
 Git branch: master
 Environment: Stage.development
 Scan policy: fetched from Safety Platform, ignoring any 
local Safety CLI policy files

Python detected. Found 1 Python pyproject.toml file, 1 
Python requirement file and 1 Python environment

âœ… backend/pyproject.toml: No issues found.

âœ… backend/requirements.txt: No issues found.

âœ… backend/venv/pyvenv.cfg: No issues found.

Tested 144 dependencies for security issues using policy 
fetched from Safety Platform
9 vulnerabilities found, 9 ignored due to policy.
0 fixes suggested, resolving 0 vulnerabilities.

Project dashboard: 
https://platform.safetycli.com/codebases/schoolhub/findings?
branch=master
Safety 3.6.1 scanning /home/user/schoolhub
2025-09-20 15:39:42 UTC

Account: gilles maury, gilmry@gmail.com 
Project: schoolhub
 Git branch: master
 Environment: Stage.development
 Scan policy: fetched from Safety Platform, ignoring any 
local Safety CLI policy files

Python detected. Found 1 Python pyproject.toml file, 1 
Python requirement file and 1 Python environment

âœ… backend/pyproject.toml: No issues found.

âœ… backend/requirements.txt: No issues found.

âœ… backend/venv/pyvenv.cfg: No issues found.

Tested 144 dependencies for security issues using policy 
fetched from Safety Platform
9 vulnerabilities found, 9 ignored due to policy.
0 fixes suggested, resolving 0 vulnerabilities.

Project dashboard: 
https://platform.safetycli.com/codebases/schoolhub/findings?
branch=master
â™¿ Accessibility (frontend)
ðŸ”Ž Running accessibility audit
ðŸ“ Using .pa11yci configuration
â„¹ï¸ Using npx pa11y-ci (network required)
